"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[465],{2465:(A,l,o)=>{o.r(l),o.d(l,{MessagesModule:()=>U});var c=o(6895),r=o(4006),m=o(8396),d=o(2912),e=o(4650),h=o(54),u=o(791);const p=["scrollframe"],f=["item"],_=function(s,i){return{avatar:s,"avatar-away":i}};function v(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"a",35),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,g=e.oxw();return e.KtG(g.selectedUser(a))}),e.TgZ(1,"div",19)(2,"div",36),e._UZ(3,"img",6),e.qZA()(),e.TgZ(4,"div",21)(5,"div")(6,"div",22),e._uU(7),e.qZA(),e.TgZ(8,"div",37),e._uU(9,"Hey, How are you?"),e.qZA()(),e.TgZ(10,"div")(11,"div",38),e._uU(12,"2 min"),e.qZA(),e.TgZ(13,"div",39),e._uU(14,"15"),e.qZA()()()()}if(2&s){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("ngClass",e.WLB(2,_,"true"===t.active,"false"===t.active)),e.xp6(5),e.hij(" ",t.firstName+" "+t.lastName,"")}}function M(s,i){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,v,15,5,"a",34),e.qZA()),2&s){const t=i.$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngIf",t._id!=n.loggedinUserID)}}function C(s,i){if(1&s&&(e.TgZ(0,"li",44)(1,"div",21)(2,"div",45)(3,"div")(4,"p"),e._uU(5),e.qZA(),e.TgZ(6,"ul",46)(7,"li")(8,"div",47)(9,"span"),e._uU(10),e.ALo(11,"date"),e.qZA()()()()()()()()),2&s){const t=e.oxw().$implicit;e.xp6(5),e.Oqu(t.message),e.xp6(5),e.Oqu(e.xi3(11,2,t.createdAt,"shortTime"))}}function Z(s,i){if(1&s&&(e.TgZ(0,"li",48)(1,"div",49),e._UZ(2,"img",50),e.qZA(),e.TgZ(3,"div",21)(4,"div",45)(5,"div")(6,"p"),e._uU(7),e.qZA(),e.TgZ(8,"ul",46)(9,"li")(10,"div",51)(11,"span"),e._uU(12),e.ALo(13,"date"),e.qZA()()()()()()()()),2&s){const t=e.oxw().$implicit;e.xp6(7),e.Oqu(t.message),e.xp6(5),e.Oqu(e.xi3(13,2,t.createdAt,"shortTime"))}}function b(s,i){if(1&s&&(e.TgZ(0,"ul",40,41),e.YNc(2,C,12,5,"li",42),e.YNc(3,Z,14,5,"li",43),e.qZA()),2&s){const t=i.$implicit,n=e.oxw();e.xp6(2),e.Q6J("ngIf",n.loggedinUserID===t.from&&n.selectedUserID===t.to),e.xp6(1),e.Q6J("ngIf",n.loggedinUserID===t.to&&n.selectedUserID===t.from)}}const O=[{path:"",component:(()=>{class s{constructor(t,n){this._messagesService=t,this._storageService=n,this.users=[],this.allMessages=[],this.latestMessage=""}ngOnInit(){this.getAllMessagedUsers(),this.refreshData()}getAllMessagedUsers(){this.loggedinUserID&&this._messagesService.getAllMessagedUsers(this.loggedinUserID).subscribe(t=>{if(t.users.length>0)if(this.users=t.users,history.state.data){let n={_id:history.state.data.userId,firstName:history.state.data.firstName,lastName:history.state.data.lastName};this.selectedUser(n)}else t.users[0]._id!=this.loggedinUserID?this.selectedUser(t.users[0]):t.users.length>1&&this.selectedUser(t.users[1])})}selectedUser(t){t&&(this.selectedUserID=t._id,this.currentUser=t.firstName+" "+t.lastName,this.getAllByFromAndTo())}get loggedinUserID(){return this._storageService.getDataFromLocalStorage("id")}send(){this._messagesService.send({from:this.loggedinUserID,to:this.selectedUserID,message:this.message}).subscribe(n=>{this.message="",this.getAllByFromAndTo()})}getAllByFromAndTo(){this._messagesService.getAllByFromAndTo({from:this.loggedinUserID,to:this.selectedUserID}).subscribe(n=>{n.results.length>0&&(this.allMessages=n.results)})}getLatestMessage(){this.latestMessage="",this.allMessages&&this.allMessages.map((t,n)=>{this.allMessages.length-1==n&&(this.latestMessage=t.message)})}ngAfterViewInit(){this.scrollContainer=this.scrollFrame.nativeElement,this.itemElements.changes.subscribe(t=>this.onItemElementsChanged())}onItemElementsChanged(){this.scrollToBottom()}scrollToBottom(){this.scrollContainer.scroll({top:this.scrollContainer.scrollHeight,left:0})}refreshData(){this.getAllByFromAndTo()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(h.K),e.Y36(u.V))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-messages"]],viewQuery:function(t,n){if(1&t&&(e.Gf(p,5),e.Gf(f,5)),2&t){let a;e.iGM(a=e.CRH())&&(n.scrollFrame=a.first),e.iGM(a=e.CRH())&&(n.itemElements=a)}},decls:43,vars:5,consts:[[1,"row","chat_wrapper"],[1,"col-xl-12"],[1,"chat-window"],[1,"chat-cont-left"],[1,"chat-search","d-flex","align-items-center"],[1,"avatar","avatar","me-3"],["src","assets/img/user/user.jpg","alt","User Image",1,"avatar-img","rounded-circle"],[1,"input-group"],[1,"input-group-prepend"],[1,"fas","fa-search"],["type","text","placeholder","Search",1,"form-control","rounded-pill"],[1,"chat-header"],[1,"chat-users-list"],[1,"chat-scroll"],[4,"ngFor","ngForOf"],[1,"chat-cont-right","msg-p"],["id","back_user_list","href","javascript:void(0)",1,"back-user-list"],[1,"material-icons"],[1,"media","d-flex"],[1,"media-img-wrap","flex-shrink-0"],[1,"avatar","avatar"],[1,"media-body","flex-grow-1"],[1,"user-name"],[1,"user-status"],[1,"chat-options"],["type","checkbox","id","rotate-trigger",1,"rotate-trigger"],["for","rotate-trigger",1,"icon-container"],[1,"fa-solid","fa-arrows-rotate",3,"click"],[1,"chat-body"],["scrollframe",""],["class","list-unstyled",4,"ngFor","ngForOf"],[1,"chat-footer","msg-f"],["type","text","placeholder","Type something",1,"input-msg-send","form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","msg-send-btn",3,"disabled","click"],["href","javascript:void(0);","class","media d-flex",3,"click",4,"ngIf"],["href","javascript:void(0);",1,"media","d-flex",3,"click"],[1,"avatar",3,"ngClass"],[1,"user-last-chat"],[1,"last-chat-time","block"],[1,"badge","badge-primary","rounded-pill"],[1,"list-unstyled"],["item",""],["class","media sent d-flex",4,"ngIf"],["class","media received d-flex",4,"ngIf"],[1,"media","sent","d-flex"],[1,"msg-box"],[1,"chat-msg-info"],[1,"chat-time","msg-send"],[1,"media","received","d-flex"],[1,"avatar","flex-shrink-0"],["src","assets/img/user/user10.jpg","alt","User Image",1,"avatar-img","rounded-circle"],[1,"chat-time","msg-rece"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4)(5,"div",5),e._UZ(6,"img",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8),e._UZ(9,"i",9),e.qZA(),e._UZ(10,"input",10),e.qZA()(),e.TgZ(11,"div",11)(12,"span"),e._uU(13,"Chats"),e.qZA()(),e.TgZ(14,"div",12)(15,"div",13),e.YNc(16,M,2,1,"div",14),e.qZA()()(),e.TgZ(17,"div",15)(18,"div",11)(19,"a",16)(20,"i",17),e._uU(21,"chevron_left"),e.qZA()(),e.TgZ(22,"div",18)(23,"div",19)(24,"div",20),e._UZ(25,"img",6),e.qZA()(),e.TgZ(26,"div",21)(27,"div",22),e._uU(28),e.qZA(),e._UZ(29,"div",23),e.qZA()(),e.TgZ(30,"div",24),e._UZ(31,"input",25),e.TgZ(32,"label",26)(33,"i",27),e.NdJ("click",function(){return n.refreshData()}),e.qZA()()()(),e.TgZ(34,"div",28,29)(36,"div"),e.YNc(37,b,4,2,"ul",30),e.qZA()(),e.TgZ(38,"div",31)(39,"div",7)(40,"input",32),e.NdJ("ngModelChange",function(g){return n.message=g}),e.qZA(),e.TgZ(41,"button",33),e.NdJ("click",function(){return n.send()}),e._uU(42,"Send"),e.qZA()()()()()()()),2&t&&(e.xp6(16),e.Q6J("ngForOf",n.users),e.xp6(12),e.Oqu(n.currentUser),e.xp6(9),e.Q6J("ngForOf",n.allMessages),e.xp6(3),e.Q6J("ngModel",n.message),e.xp6(1),e.Q6J("disabled",!n.message))},dependencies:[c.mk,c.sg,c.O5,r._Y,r.Fj,r.JJ,r.JL,r.On,r.F,c.uU],styles:[".chat-window .chat-cont-right .chat-footer .input-group .btn.msg-send-btn{border-radius:6px}.msg-send[_ngcontent-%COMP%]{color:#fff!important}.msg-rece[_ngcontent-%COMP%]{color:#32414866!important}.msg-p[_ngcontent-%COMP%]{position:relative!important}.msg-f[_ngcontent-%COMP%]{width:100%!important;position:absolute!important;bottom:0!important}.chat_wrapper[_ngcontent-%COMP%]{height:85vh!important}.chat-window[_ngcontent-%COMP%]{height:100%}.chat-options[_ngcontent-%COMP%]{color:#a5a5b0;font-size:1.2rem;margin-right:1rem}i[_ngcontent-%COMP%]{cursor:pointer}.chat-window[_ngcontent-%COMP%]   .chat-cont-left[_ngcontent-%COMP%]   .chat-users-list[_ngcontent-%COMP%]   a.media[_ngcontent-%COMP%]:las{border-bottom:none!important}.chat-cont-right[_ngcontent-%COMP%]   .chat-body[_ngcontent-%COMP%]   .media.received[_ngcontent-%COMP%]   .media-body[_ngcontent-%COMP%]   .msg-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{content:none}.chat-window[_ngcontent-%COMP%]   .chat-cont-right[_ngcontent-%COMP%]   .chat-body[_ngcontent-%COMP%]   .media.received[_ngcontent-%COMP%]   .media-body[_ngcontent-%COMP%]   .msg-box[_ngcontent-%COMP%]:first-child:before{border-bottom:6px solid transparent;border-right:6px solid #fff;border-top:6px solid transparent;content:none;height:0;left:-6px;position:absolute;right:auto;top:1px;width:0}.chat-cont-right[_ngcontent-%COMP%]   .chat-body[_ngcontent-%COMP%]   .media.received[_ngcontent-%COMP%]   .media-body[_ngcontent-%COMP%]   .msg-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{background-color:#fff;border-radius:0 14px 14px}.chat-cont-right[_ngcontent-%COMP%]   .chat-body[_ngcontent-%COMP%]{background-color:#f5f5f6;height:calc(100vh - 243px);overflow:auto}.icon-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;cursor:pointer}.fa-arrows-rotate[_ngcontent-%COMP%]{transition:transform .3s ease;color:#009da6;transform:(0deg)}.rotate-trigger[_ngcontent-%COMP%]{display:none}.rotate-trigger[_ngcontent-%COMP%]:checked + .icon-container[_ngcontent-%COMP%]   .fa-arrows-rotate[_ngcontent-%COMP%]{transform:rotate(360deg)}"]}),s})()}];let x=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[d.Bz.forChild(O),d.Bz]}),s})(),U=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[c.ez,x,r.u5,r.UX,m.U$]}),s})()}}]);