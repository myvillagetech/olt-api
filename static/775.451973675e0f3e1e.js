"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[775],{9775:(ot,h,a)=>{a.r(h),a.d(h,{TutorSchedulesModule:()=>tt});var p=a(6895),d=a(2912),Z=a(1400),y=a(2887),A=a(7914),l=a(5622),C=a(4025),t=a(4650),b=a(6864),u=a(4006),T=a(791),x=a(7185),U=a(9886),g=a(8396),f=a(805),v=a(585),S=a(5722),_=a(4484);function N(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",31)(1,"button",23),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.resetFilters())}),t._uU(2,"Reset"),t.qZA()()}}function F(o,i){1&o&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Student "),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Subjects "),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Slots"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Status"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Actions"),t.qZA()())}function P(o,i){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,s=t.oxw(2);t.xp6(1),t.AsE("",s.timeValues[e.from]," - ",s.timeValues[e.to],"")}}function q(o,i){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"timeZoneConverter"),t.ALo(3,"timeZoneConverter"),t.qZA()),2&o){const e=t.oxw().$implicit,s=t.oxw(2);t.xp6(1),t.AsE("",t.xi3(2,2,e.utcFromtime,s.loggedinUserTimeZone)," - ",t.xi3(3,5,e.utcTotime,s.loggedinUserTimeZone),"")}}function L(o,i){if(1&o&&(t.TgZ(0,"div",37)(1,"div")(2,"h5"),t._uU(3),t.ALo(4,"date"),t.qZA(),t.YNc(5,P,2,2,"p",30),t.YNc(6,q,4,8,"p",30),t.qZA()()),2&o){const e=i.$implicit;t.xp6(3),t.hij("",t.xi3(4,3,e.date,"MMM d, y")," "),t.xp6(2),t.Q6J("ngIf",!e.utcFromtime||!e.utcTotime),t.xp6(1),t.Q6J("ngIf",e.utcFromtime&&e.utcTotime)}}function D(o,i){if(1&o&&(t.TgZ(0,"div",38)(1,"h5"),t._uU(2),t.qZA(),t.TgZ(3,"p"),t._uU(4,"slots"),t.qZA()()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.hij("+ ",e.slots.length-2," ")}}function R(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td")(4,"p"),t._uU(5),t.qZA()(),t.TgZ(6,"td",32),t.NdJ("click",function(){const r=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.navigateToDetailsPage(r._id))}),t.YNc(7,L,7,6,"div",33),t.YNc(8,D,5,1,"div",34),t.qZA(),t.TgZ(9,"td")(10,"span"),t._uU(11),t.qZA()(),t.TgZ(12,"td")(13,"button",35),t.NdJ("click",function(){const r=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.navigateToDetailsPage(r._id))}),t._UZ(14,"i",36),t._uU(15," View "),t.qZA()()()}if(2&o){const e=i.$implicit,s=t.oxw();t.xp6(2),t.AsE("",e.student.firstName," ",e.student.lastName,""),t.xp6(3),t.Oqu(s.subjectCount(e.subjects)),t.xp6(2),t.Q6J("ngForOf",null==e.slots?null:e.slots.slice(0,2)),t.xp6(1),t.Q6J("ngIf",(null==e.slots?null:e.slots.length)>2),t.xp6(2),t.Tol(s.statusClass(e.status)),t.xp6(1),t.Oqu(e.status)}}function J(o,i){1&o&&(t.TgZ(0,"div")(1,"p",39),t._uU(2,"No Schedules found"),t.qZA()())}const O=function(){return[10,20,40]};let E=(()=>{class o{constructor(e,s,n,r,c,m,et){this.tutorSchedulesService=e,this.formBuilder=s,this.storageService=n,this.toastrService=r,this.modalService=c,this.router=m,this.activatedRoute=et,this.timeValues=A.a,this.scheduleTableData=[],this.statusList=l.q,this.courses=[],this.dispalyStatusList=l.s,this.scheduleTableDataLength=0,this.uniqueFirstNames=[],this.uniqueStudents=[],this.loggedinUserTimeZone="",this.isAppliedFilters=!1}ngOnInit(){const e=this.storageService.getDataFromLocalStorage("id");this.loggedinUserTimeZone=this.storageService.getDataFromLocalStorage(C.I.TIME_ZONE),this.getAllCourses(),this.genrateFiltersForm(),this.payload={pageNumber:0,pageSize:25,sortField:"updatedAt",sortOrder:-1,studentIds:[],subjects:[],tutorIds:[e],dateRange:[],status:[],...this.filtersForm.value},this.activatedRoute.queryParams.subscribe(s=>{s.status&&(this.payload.status=[s.status],this.filtersForm.controls.status.setValue([s.status])),this.getSchedules()}),this.getstudents()}getSchedules(){this.tutorSchedulesService.getSchedulesBySearchByCriteria(this.payload).subscribe(e=>{this.scheduleTableData=e.data,this.scheduleTableDataLength=e.totalCount})}getstudents(){this.tutorSchedulesService.getSchedulesBySearchByCriteria(this.payload).subscribe(e=>{const s={};for(const n of e.data){const r=n.student.firstName;s.hasOwnProperty(r)||(s[r]=n.student)}this.uniqueStudents=Object.values(s)})}genrateFiltersForm(){this.filtersForm=this.formBuilder.group({studentIds:[[]],subjects:[[]],status:[[]],dateRange:[[]]})}clear(e){e.clear()}getAllCourses(){this.tutorSchedulesService.getAllCourses().subscribe(e=>{this.courses=e.data})}applyFilters(){this.payload={...this.payload,...this.filtersForm.value,dateRange:{from:this.filtersForm.value.dateRange[0],to:this.filtersForm.value.dateRange[1]}},this.isAppliedFilters=!0,this.getSchedules()}resetFilters(){this.genrateFiltersForm(),this.isAppliedFilters=!1,this.payload={...this.payload,...this.filtersForm.value,pageNumber:0,dateRange:[]},this.getSchedules()}paginate(e){window.scroll(0,0),this.payload={...this.payload,pageNumber:e.first,pageSize:e.row},this.getSchedules()}updateSchedule(e,s){const n={...s,status:e};"CANCELLED"===e||"REJECTED"===e?(this.modalRef=this.modalService.show(y.$,{class:"modal-dialog modal-dialog-centered",initialState:{confirmMessage:"Are you sure want to "+("CANCELLED"===e?"cancel?":"reject?")}}),this.modalRef.content.onClose.subscribe(c=>{c&&this.tutorSchedulesService.updateSchedule(s._id,n).subscribe(m=>{this.toastrService.success(m.message),this.getSchedules()},m=>{this.toastrService.error(m.message??"unable to update! Please try again later")})})):this.tutorSchedulesService.updateSchedule(s._id,n).subscribe(r=>{this.toastrService.success(r.message),this.getSchedules()},r=>{this.toastrService.error(r.message??"unable to update! Please try again later")})}statusClass(e){return e===l.q.ACCEPTED?"confirm":e===l.q.REQUESTED?"pending":e===l.q.CANCELLED||e===l.q.REJECTED?"reject":e===l.q.COMPLETED||e===l.q.CONFIRMED?"accept":""}navigateToDetailsPage(e){this.router.navigate(["./tutor/schedules/details"],{queryParams:{sid:e}})}subjectCount(e){return e.length>0?e.length>2?e[0].courseName+","+e[1].courseName+" +"+(e.length-2).toString():1===e.length?e[0].courseName:e[0].courseName+","+e[1]?.courseName:""}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(b.F),t.Y36(u.qu),t.Y36(T.V),t.Y36(x._W),t.Y36(U.tT),t.Y36(d.F0),t.Y36(d.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-tutor-schedules"]],decls:52,vars:15,consts:[[1,"page-header"],[1,"row"],[1,"col"],[1,"page-title"],[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],[1,"breadcrumb-item","active"],[1,"card"],[1,"content"],[1,"col-md-12","col-lg-4","col-xl-3"],[1,"card","search-filter","StickySidebar"],[1,"card-header"],[1,"card-title","mb-0"],[1,"card-body"],[3,"formGroup"],[1,"filter-widget"],["defaultLabel","Student Name","formControlName","studentIds","optionLabel","firstName","display","chip","optionValue","_id",1,"m-1",3,"options"],["defaultLabel","Select a Courses","optionLabel","courseName","display","chip","formControlName","subjects","optionValue","courseName",1,"m-1",3,"options"],["placeholder","Select Date","formControlName","dateRange","selectionMode","range","inputId","icon","dateFormat","yy-mm-dd",1,"m-1",3,"showIcon"],[1,""],["placeholder","Select Status","optionLabel","value","optionValue","value","display","chip","autoWidth","true","formControlName","status",1,"m-1",3,"options"],[1,"btn-search"],["type","button",1,"btn","w-100",3,"click"],["class","btn-search mt-2",4,"ngIf"],[1,"col-md-12","col-lg-8","col-xl-9"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","showCurrentPageReport","rowsPerPageOptions","paginator","rows","totalRecords","onPage"],["dt1",""],["pTemplate","header"],["pTemplate","body"],[4,"ngIf"],[1,"btn-search","mt-2"],[1,"d-flex",3,"click"],["class"," m-1 p-2 accept",4,"ngFor","ngForOf"],["class","accept m-1 p-2",4,"ngIf"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"far","fa-eye"],[1,"m-1","p-2","accept"],[1,"accept","m-1","p-2"],[1,"text-danger"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t._uU(4,"Schedules"),t.qZA(),t.TgZ(5,"ul",4)(6,"li",5)(7,"a",6),t._uU(8,"Dashboard"),t.qZA()(),t.TgZ(9,"li",7),t._uU(10,"Schedules"),t.qZA()()()()(),t.TgZ(11,"div",8)(12,"div",9)(13,"div")(14,"div",1)(15,"div",10)(16,"div",11)(17,"div",12)(18,"h4",13),t._uU(19,"Search Filter"),t.qZA()(),t.TgZ(20,"div",14)(21,"form",15)(22,"div",16)(23,"h4"),t._uU(24,"Student"),t.qZA(),t.TgZ(25,"div"),t._UZ(26,"p-multiSelect",17),t.qZA()(),t.TgZ(27,"div",16)(28,"h4"),t._uU(29,"Course"),t.qZA(),t.TgZ(30,"div"),t._UZ(31,"p-multiSelect",18),t.qZA()(),t.TgZ(32,"div",16)(33,"h4"),t._uU(34,"Date "),t.qZA(),t.TgZ(35,"div"),t._UZ(36,"p-calendar",19),t.qZA()(),t.TgZ(37,"div",16)(38,"h4"),t._uU(39,"Status"),t.qZA(),t.TgZ(40,"div",20),t._UZ(41,"p-multiSelect",21),t.qZA()(),t.TgZ(42,"div",22)(43,"button",23),t.NdJ("click",function(){return s.applyFilters()}),t._uU(44,"Search"),t.qZA()(),t.YNc(45,N,3,0,"div",24),t.qZA()()()(),t.TgZ(46,"div",25)(47,"p-table",26,27),t.NdJ("onPage",function(r){return s.paginate(r)}),t.YNc(49,F,11,0,"ng-template",28),t.YNc(50,R,16,8,"ng-template",29),t.qZA(),t.YNc(51,J,3,0,"div",30),t.qZA()()()()()),2&e&&(t.xp6(7),t.Q6J("routerLink","/tutor/dashboard"),t.xp6(14),t.Q6J("formGroup",s.filtersForm),t.xp6(5),t.Q6J("options",s.uniqueStudents),t.xp6(5),t.Q6J("options",s.courses),t.xp6(5),t.Q6J("showIcon",!0),t.xp6(5),t.Q6J("options",s.dispalyStatusList),t.xp6(4),t.Q6J("ngIf",s.isAppliedFilters),t.xp6(2),t.Q6J("value",s.scheduleTableData)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(14,O))("paginator",!0)("rows",10)("totalRecords",s.scheduleTableDataLength),t.xp6(4),t.Q6J("ngIf",0==s.scheduleTableData.length))},dependencies:[p.sg,p.O5,d.yS,g.iA,f.jx,v.f,S.NU,u._Y,u.JJ,u.JL,u.sg,u.u,p.uU,_.Q],styles:[".p-datepicker table td{padding:0!important}.StickySidebar[_ngcontent-%COMP%]{position:sticky;top:100px}"]}),o})();var I=a(3058);function M(o,i){1&o&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"No. Of Schedules"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Amount"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Payment Id"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Date"),t.qZA()())}function Y(o,i){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"date"),t.qZA()()),2&o){const e=i.$implicit;t.xp6(2),t.Oqu(e.scheduleIds.length),t.xp6(2),t.Oqu(e.amount),t.xp6(2),t.Oqu(e.paymentId),t.xp6(2),t.Oqu(t.xi3(9,4,e.createdAt,"MMM d, y"))}}const Q=function(){return[10,20,40]},w=[{path:"",component:E},{path:"details",component:Z.B},{path:"payouts",component:(()=>{class o{constructor(e,s){this.tutorProfileService=e,this.storageService=s,this.payoutsTableDataLength=0,this.filterObject={pageNumber:0,pageSize:20,sortField:"updatedAt",sortOrder:-1,studentId:"",paymentId:""}}ngOnInit(){const e=this.storageService.getDataFromLocalStorage("id");e&&(this.filterObject.tutorId=e,this.getAllTutorPayouts())}getAllTutorPayouts(){this.tutorProfileService.getAllTutorPayouts(this.filterObject).subscribe(e=>{this.payouts=e.payment[0].payments,this.payoutsTableDataLength=e.payment[0].metrics[0].totalCount})}paginate(e){this.filterObject.pageNumber=e.first,this.filterObject.pageSize=e.row,this.getAllTutorPayouts()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(I.U),t.Y36(T.V))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-tutor-payout"]],decls:17,vars:8,consts:[[1,"page-header"],[1,"row"],[1,"col"],[1,"page-title"],[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],[1,"breadcrumb-item","active"],[1,"card"],[1,"content"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","showCurrentPageReport","rowsPerPageOptions","paginator","rows","totalRecords","onLazyLoad"],["dt1",""],["pTemplate","header"],["pTemplate","body"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t._uU(4,"Payouts"),t.qZA(),t.TgZ(5,"ul",4)(6,"li",5)(7,"a",6),t._uU(8,"Dashboard"),t.qZA()(),t.TgZ(9,"li",7),t._uU(10,"Payouts"),t.qZA()()()()(),t.TgZ(11,"div",8)(12,"div",9)(13,"p-table",10,11),t.NdJ("onLazyLoad",function(r){return s.paginate(r)}),t.YNc(15,M,9,0,"ng-template",12),t.YNc(16,Y,10,7,"ng-template",13),t.qZA()()()),2&e&&(t.xp6(7),t.Q6J("routerLink","/tutor/dashboard"),t.xp6(6),t.Q6J("value",s.payouts)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(7,Q))("paginator",!0)("rows",10)("totalRecords",s.payoutsTableDataLength))},dependencies:[d.yS,g.iA,f.jx,p.uU]}),o})()}];let z=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[d.Bz.forChild(w),d.Bz]}),o})();var B=a(5593),V=a(2210),$=a(1740),G=a(8177),H=a(8235),K=a(4076),W=a(1493),X=a(1997),k=a(4466);let tt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.ez,z,g.U$,v._8,G.JH,W.S,S.q4,K.vI,V.kW,B.hJ,$.j,H.q,u.u5,u.UX,X.U,k.m]}),o})()}}]);