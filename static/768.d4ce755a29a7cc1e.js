"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[768],{5622:(h,y,o)=>{o.d(y,{q:()=>l,s:()=>p});var l=(()=>{return(u=l||(l={})).REQUESTED="REQUESTED",u.ACCEPTED="ACCEPTED",u.REJECTED="REJECTED",u.CANCELLED="CANCELLED",u.COMPLETED="COMPLETED",u.CONFIRMED="CONFIRMED",l;var u})();const p=[{value:"REQUESTED",label:"Requested"},{value:"ACCEPTED",label:"Accepted"},{value:"REJECTED",label:"Rejected"},{value:"CANCELLED",label:"Cancelled"},{value:"COMPLETED",label:"Completed"},{value:"CONFIRMED",label:"Confirmed"}]},4009:(h,y,o)=>{o.r(y),o.d(y,{PaymentPageModule:()=>B});var l=o(6895),p=o(2912),u=o(5622),e=o(4650),m=o(4946),T=o(7185),C=o(6557);let b=(()=>{class n{constructor(t){this.httpDataService=t}postPayment(t){return this.httpDataService.post("payments/updatePayment",t)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(C.L))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var A=o(5861);function x(n){var a="";return Object.keys(n).forEach(function(t){0!==a.length&&(a+="&"),a+=t+"="+n[t]}),a}function f(n,a){void 0===a&&(a={});var t=document.createElement("script");return t.src=n,Object.keys(a).forEach(function(r){t.setAttribute(r,a[r]),"data-csp-nonce"===r&&t.setAttribute("nonce",a["data-csp-nonce"])}),t}function v(n){return window[n]}function P(n,a){if("object"!=typeof n||null===n)throw new Error("Expected an options object.");if(typeof a<"u"&&"function"!=typeof a)throw new Error("Expected PromisePonyfill to be a function.")}var g=o(2340);const I=["paypal"];let N=(()=>{class n{constructor(t){this.studentSchedulesService=t,this.isPaymentSuccess=new e.vpe,this.amountToPaid=0,this.amountToPaid=this.studentSchedulesService.amountToBePaid,this.paymentDetails=this.studentSchedulesService.selectedScheduleDetails,this.payerDetails=this.paymentDetails?.student[0],this.tutorDetails=this.paymentDetails?.tutor[0]}ngOnInit(){this.renderPaypalButton()}renderPaypalButton(){var t=this;(function U(n,a){if(void 0===a&&(a=Promise),P(n,a),typeof document>"u")return a.resolve(null);var t=function _(n){var a="https://www.paypal.com/sdk/js";n.sdkBaseUrl&&(a=n.sdkBaseUrl,delete n.sdkBaseUrl);var t=n,r=Object.keys(t).filter(function(s){return typeof t[s]<"u"&&null!==t[s]&&""!==t[s]}).reduce(function(s,d){var E=t[d].toString();return d=function w(n){return n.replace(/[A-Z]+(?![a-z])|[A-Z]/g,function(t,r){return(r?"-":"")+t.toLowerCase()})}(d),"data"===d.substring(0,4)?s.dataAttributes[d]=E:s.queryParams[d]=E,s},{queryParams:{},dataAttributes:{}}),i=r.queryParams,c=r.dataAttributes;return i["merchant-id"]&&-1!==i["merchant-id"].indexOf(",")&&(c["data-merchant-id"]=i["merchant-id"],i["merchant-id"]="*"),{url:"".concat(a,"?").concat(x(i)),dataAttributes:c}}(n),r=t.url,i=t.dataAttributes,c=i["data-namespace"]||"paypal",s=v(c);return function D(n,a){var t=document.querySelector('script[src="'.concat(n,'"]'));if(null===t)return null;var r=f(n,a),i=t.cloneNode();if(delete i.dataset.uidAuto,Object.keys(i.dataset).length!==Object.keys(r.dataset).length)return null;var c=!0;return Object.keys(i.dataset).forEach(function(s){i.dataset[s]!==r.dataset[s]&&(c=!1)}),c?t:null}(r,i)&&s?a.resolve(s):function O(n,a){void 0===a&&(a=Promise),P(n,a);var t=n.url,r=n.attributes;if("string"!=typeof t||0===t.length)throw new Error("Invalid url.");if(typeof r<"u"&&"object"!=typeof r)throw new Error("Expected attributes to be an object.");return new a(function(i,c){if(typeof document>"u")return i();!function Z(n){var r=n.onSuccess,i=n.onError,c=f(n.url,n.attributes);c.onerror=i,c.onload=r,document.head.insertBefore(c,document.head.firstElementChild)}({url:t,attributes:r,onSuccess:function(){return i()},onError:function(){var s=new Error('The script "'.concat(t,'" failed to load. Check the HTTP status code and response body in DevTools to learn more.'));return c(s)}})})}({url:r,attributes:i},a).then(function(){var d=v(c);if(d)return d;throw new Error("The window.".concat(c," global variable is not available."))})})({clientId:"AdGG8yJPwquu_0QsrMVWY7jBiavy9nEkZE5ESLLRmNQ_sjeK_t1zNuDxw9vdDHtxXQzFGS3EgBGeE4Pp",currency:"USD"}).then(r=>{var i;r.Buttons({style:{shape:"rect",color:"gold",layout:"vertical",label:"paypal"},createOrder:(i=(0,A.Z)(function*(){const s=yield(yield fetch(`${g.N.PAYMENTS_URL}paypal/create_order`,{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({value:t.amountToPaid,intent:"CAPTURE"})})).json();return t.orderId=s.id,s.id}),function(){return i.apply(this,arguments)}),onApprove:(i,c)=>fetch(`${g.N.PAYMENTS_URL}paypal/complete_order`,{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({intent:"CAPTURE",order_id:this.orderId})}).then(s=>s.json()).then(s=>{console.log(s),this.isPaymentSuccess.emit({...s,id:this.orderId})}),onCancel:()=>{},onError:function(i){}}).render(this.paypalElement.nativeElement)}).catch(r=>{console.error("failed to load the PayPal JS SDK script",r)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.g))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-paypal-payment-page"]],viewQuery:function(t,r){if(1&t&&e.Gf(I,7),2&t){let i;e.iGM(i=e.CRH())&&(r.paypalElement=i.first)}},outputs:{isPaymentSuccess:"isPaymentSuccess"},decls:4,vars:0,consts:[[1,"payment-div"],[1,"payment-inner-div"],["paypal",""]],template:function(t,r){1&t&&(e.TgZ(0,"div")(1,"div",0),e._UZ(2,"div",1,2),e.qZA()())},styles:[".payment-div[_ngcontent-%COMP%]{display:flex;justify-content:center}.payment-inner-div[_ngcontent-%COMP%]{min-width:500px}"]}),n})();function M(n,a){if(1&n&&(e.TgZ(0,"div",18)(1,"ul",19)(2,"li")(3,"div",20)(4,"div",21)(5,"span"),e._uU(6,"Full Name"),e.qZA(),e.TgZ(7,"div",13),e._uU(8),e.qZA()()()(),e.TgZ(9,"li")(10,"div",20)(11,"div",21)(12,"span"),e._uU(13,"Email"),e.qZA(),e.TgZ(14,"div",13),e._uU(15),e.qZA()()()()()()),2&n){const t=e.oxw();e.xp6(8),e.AsE("",t.payerDetails.firstName," ",t.payerDetails.lastName,""),e.xp6(7),e.Oqu(t.payerDetails.email)}}function R(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"app-paypal-payment-page",22),e.NdJ("isPaymentSuccess",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.handleIsPaymentSuccess(i))}),e.qZA()()}}function j(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",23)(2,"div",9)(3,"div",24),e._UZ(4,"i",25),e.TgZ(5,"h3"),e._uU(6,"Appointment booked Successfully!"),e.qZA(),e.TgZ(7,"p"),e._uU(8,"Appointment booked with "),e.TgZ(9,"strong"),e._uU(10),e.qZA()(),e.TgZ(11,"p"),e._uU(12,"Ref Id "),e.TgZ(13,"strong"),e._uU(14),e.qZA()(),e.TgZ(15,"a",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.navigateToSchedules())}),e._uU(16,"Back to Schedules"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(10),e.Oqu(t.tutorDetails.firstName),e.xp6(4),e.Oqu(t.successPaymentDetails.id)}}const L=[{path:"",component:(()=>{class n{constructor(t,r,i,c){this.router=t,this.studentSchedulesService=r,this.toastrService=i,this.paymentPageService=c,this.amountToPaid=0,this.isPaymentSuccess=!1,this.amountToPaid=this.studentSchedulesService.amountToBePaid,this.paymentDetails=this.studentSchedulesService.selectedScheduleDetails,this.payerDetails=this.paymentDetails?.student[0],this.tutorDetails=this.paymentDetails?.tutor[0]}ngOnInit(){}handleIsPaymentSuccess(t){"CONFIRMED"===t.status||"COMPLETED"===t.status||"Success"===t.status?(this.paymentPageService.postPayment({scheduleIds:[this.paymentDetails?._id],paymentId:t.id,status:u.q.CONFIRMED,paymentInfo:t,amount:this.amountToPaid}).subscribe(i=>{this.toastrService.success("Thankyou! Payment Successfull")}),this.isPaymentSuccess=!0,this.successPaymentDetails=t):this.toastrService.error("Sorry! Payment unsuccessfull Please try again")}navigateToSchedules(){this.router.navigate(["student/schedules"])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.F0),e.Y36(m.g),e.Y36(T._W),e.Y36(b))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-payment-page"]],decls:31,vars:6,consts:[[1,"page-header"],[1,"row"],[1,"col"],[1,"page-title"],[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],[1,"breadcrumb-item","active"],[1,"card"],[1,"card-body"],[1,"experience-content","mb-3"],[1,"timeline-content","card"],[1,"card-header"],[1,"row-result"],[1,"widget","experience-widget","mb-2","card"],[1,"widget-title"],["class","experience-box card-body",4,"ngIf"],[4,"ngIf"],[1,"experience-box","card-body"],[1,"experience-list","profile-custom-list"],[1,"experience-content"],[1,"timeline-content"],[3,"isPaymentSuccess"],[1,"card","success-card"],[1,"success-cont"],[1,"fas","fa-check"],[1,"btn","btn-primary","view-inv-btn",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),e._uU(4,"Payment"),e.qZA(),e.TgZ(5,"ul",4)(6,"li",5)(7,"a",6),e._uU(8,"Dashboard"),e.qZA()(),e.TgZ(9,"li",5)(10,"a",6),e._uU(11,"Schedules"),e.qZA()(),e.TgZ(12,"li",7),e._uU(13,"Payment Page"),e.qZA()()()()(),e.TgZ(14,"div",8)(15,"div",9)(16,"div",10)(17,"div",11)(18,"div",12)(19,"h4"),e._uU(20,"Amount to be Paid"),e.qZA()(),e.TgZ(21,"div",9)(22,"h4",13),e._uU(23),e.qZA()()()(),e.TgZ(24,"div",14)(25,"div",12)(26,"h4",15),e._uU(27,"Payer Details"),e.qZA()(),e.YNc(28,M,16,3,"div",16),e.qZA()()(),e.YNc(29,R,2,0,"div",17),e.YNc(30,j,17,2,"div",17)),2&t&&(e.xp6(7),e.Q6J("routerLink","/student/dashboard"),e.xp6(3),e.Q6J("routerLink","/student/schedules"),e.xp6(13),e.hij("$ ",r.amountToPaid,""),e.xp6(5),e.Q6J("ngIf",r.payerDetails),e.xp6(1),e.Q6J("ngIf",!r.isPaymentSuccess),e.xp6(1),e.Q6J("ngIf",r.isPaymentSuccess))},dependencies:[l.O5,p.yS,N]}),n})()}];let q=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[p.Bz.forChild(L),p.Bz]}),n})(),B=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[l.ez,q]}),n})()},4946:(h,y,o)=>{o.d(y,{g:()=>p});var l=o(4650);let p=(()=>{class u{constructor(){this.amountToBePaid=0}updateSelectedScheduleDetails(m){this.selectedScheduleDetails=m}updateAmount(m){this.amountToBePaid=m}}return u.\u0275fac=function(m){return new(m||u)},u.\u0275prov=l.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()}}]);